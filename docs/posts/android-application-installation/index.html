<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" data-mode="light">
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="Android’s Install Flow: A treasure map for exploit crafters" />
<meta property="og:locale" content="en" />
<meta name="description" content="In my previous post, Samsung’s ISVP: Betraying the Trust of Security Researchers, I shared my experience uncovering a vulnerability in Samsung mobile devices that enabled silent app installation." />
<meta property="og:description" content="In my previous post, Samsung’s ISVP: Betraying the Trust of Security Researchers, I shared my experience uncovering a vulnerability in Samsung mobile devices that enabled silent app installation." />
<link rel="canonical" href="https://konata.github.io/posts/android-application-installation/" />
<meta property="og:url" content="https://konata.github.io/posts/android-application-installation/" />
<meta property="og:site_name" content="开元米粉实力代购" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-05-20T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Android’s Install Flow: A treasure map for exploit crafters" />
<meta name="twitter:site" content="@minamikazecafe" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-05-20T21:09:28+08:00","datePublished":"2025-05-20T00:00:00+08:00","description":"In my previous post, Samsung’s ISVP: Betraying the Trust of Security Researchers, I shared my experience uncovering a vulnerability in Samsung mobile devices that enabled silent app installation.","headline":"Android’s Install Flow: A treasure map for exploit crafters","mainEntityOfPage":{"@type":"WebPage","@id":"https://konata.github.io/posts/android-application-installation/"},"url":"https://konata.github.io/posts/android-application-installation/"}</script>
<!-- End Jekyll SEO tag -->


  <title>Android’s Install Flow: A treasure map for exploit crafters | 开元米粉实力代购
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="开元米粉实力代购">
<meta name="application-name" content="开元米粉实力代购">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="https://avatars.githubusercontent.com/u/227627?v=4" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">开元米粉实力代购</a>
    <p class="site-subtitle fst-italic mb-0">納めましょう妄想税</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    

    
      

      
        <a
          href="https://github.com/konata"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://twitter.com/minamikazecafe"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-twitter"></i>
        </a>
      
    
      

      
        <a
          href="javascript:location.href = 'mailto:' + ['minamikazecafe','gmail.com'].join('@')"
          aria-label="email"
          

          

          

          
        >
          <i class="fas fa-envelope"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>Android’s Install Flow: A treasure map for exploit crafters</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>Android’s Install Flow: A treasure map for exploit crafters</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1747670400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May 20, 2025
</time>

      </span>

      <!-- lastmod date -->
      
        <span>
          Updated
          <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1747746568"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  May 20, 2025
</time>

        </span>
      

      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/minamikazecafe">natsuki</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="1732 words"
>
  <em>9 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">Android’s Install Flow: A treasure map for exploit crafters</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">Android’s Install Flow: A treasure map for exploit crafters</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <p>In my previous post, <a href="/posts/samsung-bugbounty-scam">Samsung’s ISVP: Betraying the Trust of Security Researchers</a>, I shared my experience uncovering a vulnerability in Samsung mobile devices that enabled silent app installation.</p>

<p>This flaw allowed non-privileged apps to bypass the <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/core/res/AndroidManifest.xml;drc=82ada6503a81af7eeed2924a2d2d942375f6c8c2;l=6054"><code class="language-plaintext highlighter-rouge">android.permission.INSTALL_PACKAGES</code></a> signature permission, permitting silent application installations, bypassing the user confirmation dialog normally enforced by <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code></p>

<p>Despite Samsung’s ISVP policy specifying a $50,000 reward for such vulnerabilities, I received only $500, and my follow-up inquiries were ignored. While some recommended publicly disclosing the vulnerability details, doing so would breach the program’s ToS.</p>

<p>Instead, this post examines the general Android app installation process, drawing on publicly available code from AOSP android-15.0.0_r1. The discussion is not specific to Samsung devices or the vulnerability I reported, focusing solely on open-source mechanisms.</p>

<h2 id="key-components"><span class="me-2">Key Components</span><a href="#key-components" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>This section outlines the primary components involved in Android’s application installation process. It focuses on system services, privileged apps, and client interactions, providing a general overview independent of any vendor-specific implementations.</p>

<h3 id="packageinstallerservice"><span class="me-2">PackageInstallerService</span><a href="#packageinstallerservice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">PackageInstallerService</code> is a core system service that manages application installation sessions. Hosted in <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/services/core/java/com/android/server/pm/PackageInstallerService.java">PackageInstallerService.java</a>, it provides methods to create, manage, and finalize installation sessions. Key methods include:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">createSession(sessionParam, installerPackageName, callingAttributionTag, userId): Int</code></strong></p>

    <blockquote>
      <p>Create a new session using the given parameters, returning a unique ID that represents the session. Once created, the session can be opened multiple times across multiple device boots.
The system may automatically destroy sessions that have not been finalized (either committed or abandoned) within a reasonable period of time, typically on the order of a day.</p>
    </blockquote>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">openSession(sessionId): IPackageInstallerSession</code></strong></p>

    <blockquote>
      <p>Open an existing session to actively perform work. To succeed, the caller must be the owner of the install session.</p>
    </blockquote>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">getSessionInfo(sessionId): PackageInstaller.SessionInfo</code></strong></p>

    <blockquote>
      <p>Return details for a specific session. Callers need to either declare <queries> element with the specific package name in the app's manifest, have the `android.permission.QUERY_ALL_PACKAGES`, or be the session owner to retrieve these details.</queries></p>
    </blockquote>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">setPermissionsResult(sessionId, accepted)</code></strong></p>

    <blockquote>
      <p>A hidden API for privileged callers to notify <code class="language-plaintext highlighter-rouge">PackageInstallerService</code> that the user has approved an installation request, allowing the installation to proceed.</p>
    </blockquote>
  </li>
</ul>

<h3 id="packageinstallersession"><span class="me-2">PackageInstallerSession</span><a href="#packageinstallersession" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">PackageInstallerSession</code> class handles the active phase of an installation session, enabling data writing and session finalization. Key methods include:</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">openWrite(name, offset, length): ParcelFileDescriptor</code></strong></p>

    <blockquote>
      <p>Open a stream to write an APK file into the session.
The returned stream will start writing data at the requested offset in the underlying file, which can be used to resume a partially written file. If a valid file length is specified, the system will preallocate the underlying disk space to optimize placement on disk. It’s strongly recommended to provide a valid file length when known.
You can write data into the returned stream, optionally call fsync(OutputStream) as needed to ensure bytes have been persisted to disk, and then close when finished. All streams must be closed before calling commit(IntentSender).</p>
    </blockquote>
  </li>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">commit(statusReceiver, forTransferred)</code></strong></p>

    <blockquote>
      <p>Commit the session when all constraints are satisfied. This is a convenient method to combine waitForInstallConstraints(List, PackageInstaller. InstallConstraints, IntentSender, long) and PackageInstaller. Session. commit(IntentSender).
Once this method is called, the session is sealed and no additional mutations may be performed on the session. In the case of timeout, you may commit the session again using this method or PackageInstaller. Session. commit(IntentSender) for retries.</p>
    </blockquote>
  </li>
</ul>

<h3 id="packageinstaller"><span class="me-2">PackageInstaller</span><a href="#packageinstaller" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The <code class="language-plaintext highlighter-rouge">PackageInstaller</code> system app (<code class="language-plaintext highlighter-rouge">com.android.packageinstaller</code>) facilitates sideloading of applications. It interacts with <code class="language-plaintext highlighter-rouge">PackageInstallerService</code> &amp; <code class="language-plaintext highlighter-rouge">PackageInstallerSession</code> to provide a user interface for installation prompts and manage the installation process.</p>

<h3 id="oem-privileged-app-stores"><span class="me-2">OEM Privileged App Stores</span><a href="#oem-privileged-app-stores" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Although not the focus of this post, OEM app stores (such as Google Play, Samsung Galaxy Store, Huawei AppGallery, and Oppo/Vivo/Xiaomi stores) typically hold the <code class="language-plaintext highlighter-rouge">INSTALL_PACKAGES</code> permission. These stores are common entry points for installing third-party applications, often referred to as app store installations, in contrast to sideloading like <code class="language-plaintext highlighter-rouge">PIA</code> or <code class="language-plaintext highlighter-rouge">Session Install</code>.</p>

<h3 id="client-applications"><span class="me-2">Client Applications</span><a href="#client-applications" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Client apps are non-privileged applications that initiate app installations. They interact with <code class="language-plaintext highlighter-rouge">PackageInstallerService</code> and (or) <code class="language-plaintext highlighter-rouge">PackageInstaller</code> through APIs or ACTIONs to request installation sessions</p>

<h2 id="sideloading"><span class="me-2">Sideloading</span><a href="#sideloading" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Android supports two methods for requesting application installation: <code class="language-plaintext highlighter-rouge">PIA</code> and <code class="language-plaintext highlighter-rouge">Session Install</code>. These are informal terms used within the AOSP codebase. In this post, <code class="language-plaintext highlighter-rouge">PIA</code> refers to the traditional app installation approach utilize the <code class="language-plaintext highlighter-rouge">android.intent.action.INSTALL_PACKAGE</code> action, while <code class="language-plaintext highlighter-rouge">Session Install</code> denotes a newer API set introduced in Android L. <code class="language-plaintext highlighter-rouge">PIA</code> delegates most tasks to the <code class="language-plaintext highlighter-rouge">PackageInstaller</code> app, whereas <code class="language-plaintext highlighter-rouge">Session Install</code> offers apps finer control over the installation process. Additionally, only <code class="language-plaintext highlighter-rouge">Session Install</code> supports multi-package installations, sometimes called <code class="language-plaintext highlighter-rouge">splits</code>.</p>

<p>Since <code class="language-plaintext highlighter-rouge">PackageInstaller</code> internally uses <code class="language-plaintext highlighter-rouge">Session Install</code> to interact with <code class="language-plaintext highlighter-rouge">PackageInstallerSession</code> for installations triggered by <code class="language-plaintext highlighter-rouge">PIA</code>, I’ll discuss <code class="language-plaintext highlighter-rouge">Session Install</code> first.</p>

<h3 id="session-install"><span class="me-2">Session Install</span><a href="#session-install" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The core APIs for <code class="language-plaintext highlighter-rouge">Session Install</code> were covered in the previous chapter. In essence, the process can be summarized as follows:</p>

<div class="language-kotlin highlighter-rouge"><div class="code-header">
        <span data-label-text="Kotlin"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre><span class="nf">with</span><span class="p">(</span><span class="n">packageManager</span><span class="p">.</span><span class="n">packageInstaller</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">val</span> <span class="py">session</span> <span class="p">=</span> <span class="nf">openSession</span><span class="p">(</span><span class="nf">createSession</span><span class="p">(</span><span class="nc">PackageInstaller</span><span class="p">.</span><span class="nc">SessionParams</span><span class="p">(</span><span class="nc">MODE_FULL_INSTALL</span><span class="p">)))</span>
    <span class="n">session</span><span class="p">.</span><span class="nf">openWrite</span><span class="p">(</span><span class="s">"foobar.apk"</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">).</span><span class="nf">use</span><span class="p">(</span><span class="n">assets</span><span class="p">.</span><span class="k">open</span><span class="p">(</span><span class="s">"magisk.apk"</span><span class="p">)</span><span class="o">::</span><span class="n">copyTo</span><span class="p">)</span>
    <span class="n">session</span><span class="p">.</span><span class="nf">commit</span><span class="p">(</span><span class="nc">IntentSender</span><span class="p">(</span><span class="kd">object</span> <span class="err">: </span><span class="nc">IIntentSender</span><span class="p">.</span><span class="nc">Stub</span><span class="p">()</span> <span class="p">{</span> <span class="c1">// ⬅️ 1</span>
        <span class="k">override</span> <span class="k">fun</span> <span class="nf">send</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nc">Int</span><span class="p">,</span> <span class="n">intent</span><span class="p">:</span> <span class="nc">Intent</span><span class="p">,</span> <span class="n">resolvedType</span><span class="p">:</span> <span class="nc">String</span><span class="p">?,</span> <span class="n">whitelistToken</span><span class="p">:</span> <span class="nc">IBinder</span><span class="p">?,</span> <span class="n">finishedReceiver</span><span class="p">:</span> <span class="nc">IIntentReceiver</span><span class="p">?,</span> <span class="n">requiredPermission</span><span class="p">:</span> <span class="nc">String</span><span class="p">?,</span> <span class="n">options</span><span class="p">:</span> <span class="nc">Bundle</span><span class="p">?)</span> <span class="p">{</span>
            <span class="c1">// ⬇️ 2</span>
            <span class="n">intent</span><span class="p">.</span><span class="n">extras</span><span class="o">?.</span><span class="nf">getParcelable</span><span class="p">(</span><span class="nc">Intent</span><span class="p">.</span><span class="nc">EXTRA_INTENT</span><span class="p">,</span> <span class="nc">Intent</span><span class="o">::</span><span class="k">class</span><span class="p">.</span><span class="n">java</span><span class="p">)</span><span class="o">?.</span><span class="nf">let</span><span class="p">(</span><span class="o">::</span><span class="n">startActivity</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}))</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></div></div>

<p>This code initiates a session, writes the apk content, and commits the session. Once <code class="language-plaintext highlighter-rouge">commit</code> is called, the <code class="language-plaintext highlighter-rouge">PackageInstallerSession</code> workflow starts.</p>

<ul>
  <li>
    <p><strong><code class="language-plaintext highlighter-rouge">PackageInstallerSession.commit</code></strong></p>

    <blockquote>
      <p><code class="language-plaintext highlighter-rouge">PackageInstallerSession</code> dispatches <code class="language-plaintext highlighter-rouge">MSG_ON_SESSION_SEALED</code>, <code class="language-plaintext highlighter-rouge">MSG_STREAM_VALIDATE_AND_COMMIT</code>, and <code class="language-plaintext highlighter-rouge">MSG_INSTALL</code> sequentially, each following the completion of the previous step.</p>
    </blockquote>

    <ul>
      <li><strong><code class="language-plaintext highlighter-rouge">MSG_INSTALL</code></strong>
        <blockquote>
          <p>When <code class="language-plaintext highlighter-rouge">MSG_INSTALL</code> is sent, the <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/services/core/java/com/android/server/pm/PackageInstallerSession.java;l=2845"><code class="language-plaintext highlighter-rouge">handleInstall</code></a> method is invoked. This method calls <code class="language-plaintext highlighter-rouge">sendPendingUserActionIntentIfNeeded</code> to determine if user approval is required.</p>
        </blockquote>
        <ul>
          <li><strong><code class="language-plaintext highlighter-rouge">sendPendingUserActionIntentIfNeeded</code></strong>
            <blockquote>
              <p>Invokes <code class="language-plaintext highlighter-rouge">checkUserActionRequirement</code> to evaluate the need for user action.</p>
            </blockquote>
            <ul>
              <li><strong><code class="language-plaintext highlighter-rouge">checkUserActionRequirement</code></strong>
                <blockquote>
                  <p>Uses <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/services/core/java/com/android/server/pm/PackageInstallerSession.java;l=1035"><code class="language-plaintext highlighter-rouge">computeUserActionRequirement</code></a> to calculate the user action requirement. For non-privileged apps, the result is typically <code class="language-plaintext highlighter-rouge">USER_ACTION_REQUIRED</code>, triggering the <code class="language-plaintext highlighter-rouge">IntentSender</code> to be sent with additional extras, including:</p>
                </blockquote>
                <ul>
                  <li><code class="language-plaintext highlighter-rouge">Intent.EXTRA_INTENT</code>: <strong>The intent the client app must invoke to start the user action process, always pointing to <code class="language-plaintext highlighter-rouge">PackageInstaller</code> with the action <code class="language-plaintext highlighter-rouge">ACTION_CONFIRM_INSTALL</code>.</strong></li>
                  <li><code class="language-plaintext highlighter-rouge">EXTRA_SESSION_ID</code>: The current session ID.</li>
                  <li><code class="language-plaintext highlighter-rouge">EXTRA_STATUS</code>: Indicates that the installation is suspended, awaiting user action.</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>

    <p>At this point, the installation process is paused (state recorded internally and return), and the <code class="language-plaintext highlighter-rouge">IntentSender</code> provided by the client app is triggered. The client app is expected to handle the filled intent and start the <code class="language-plaintext highlighter-rouge">Intent.EXTRA_INTENT</code> intent</p>
  </li>
  <li>
    <p><code class="language-plaintext highlighter-rouge">PackageInstaller</code> Workflow</p>

    <p>The <code class="language-plaintext highlighter-rouge">PackageInstaller</code> system app (<code class="language-plaintext highlighter-rouge">com.android.packageinstaller</code>) manages the user-facing installation process in Android. When a client app try to resume the installation by starting the <code class="language-plaintext highlighter-rouge">EXTRA_INTENT</code> in its intent, the system resolves it to the <code class="language-plaintext highlighter-rouge">InstallStart</code> activity within <code class="language-plaintext highlighter-rouge">PackageInstaller</code>, based on its defined intent filter.</p>

    <div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">".InstallStart"</span> <span class="na">android:exported=</span><span class="s">"true"</span> <span class="na">android:excludeFromRecents=</span><span class="s">"true"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;intent-filter</span> <span class="na">android:priority=</span><span class="s">"1"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.content.pm.action.CONFIRM_INSTALL"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</pre></td></tr></tbody></table></code></div>    </div>

    <p><code class="language-plaintext highlighter-rouge">InstallStart</code> activity performs initial validation checks and delegates the remaining process to <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code>.</p>

    <ul>
      <li>
        <p><strong>PackageInstallerActivity</strong></p>

        <p>The <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code> retrieves session details committed by the client app using <code class="language-plaintext highlighter-rouge">PackageInstaller.getSessionInfo(sessionId)</code>. It accesses the apk file saved by <code class="language-plaintext highlighter-rouge">PackageInstallerService</code>, typically located at <code class="language-plaintext highlighter-rouge">/data/app/vmdl${random-digital}.tmp/base.apk</code>. The activity parses the apk to extract metadata, such as the application’s icon and name, and displays a dialog prompting the user to confirm or cancel the installation.
<a href="/assets/images/android-application-installation/user-approval-dialog.png" class="popup img-link shimmer"><img src="/assets/images/android-application-installation/user-approval-dialog.png" alt="user-approval-dialog" loading="lazy"></a>,</p>

        <div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>* Hist  #1: ActivityRecord{1a9977 u0 com.android.packageinstaller/.PackageInstallerActivity t191}
* Hist  #0: ActivityRecord{59b2c54 u0 play.ground/.IndexActivity t191}
* Hist  #0: ActivityRecord{5bbee2e u0 com.android.launcher3/.uioverrides.QuickstepLauncher t178}
* Hist  #0: ActivityRecord{197f44f u0 com.android.dialer/.main.impl.MainActivity t187}
</pre></td></tr></tbody></table></code></div>        </div>

        <p>When the user clicks “Install” in the dialog, <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code> records a <code class="language-plaintext highlighter-rouge">RESULT_OK</code> state and call the overridden <code class="language-plaintext highlighter-rouge">finish</code>. On <code class="language-plaintext highlighter-rouge">RESULT_OK</code>, <code class="language-plaintext highlighter-rouge">finish</code> calls <code class="language-plaintext highlighter-rouge">PackageInstaller.setPermissionsResult(mSessionId, true)</code> via AIDL, prompting <code class="language-plaintext highlighter-rouge">PackageInstallerService</code> to locate the session by <code class="language-plaintext highlighter-rouge">sessionId</code>, set its <code class="language-plaintext highlighter-rouge">mPermissionsManuallyAccepted</code> flag to <code class="language-plaintext highlighter-rouge">true</code>, and resume the suspended installation process, completing the installation smoothly.</p>

        <p>The <code class="language-plaintext highlighter-rouge">setPermissionsResult</code> method, restricted to apps with the <code class="language-plaintext highlighter-rouge">INSTALL_PACKAGES</code> permission, ensures only privileged components like <code class="language-plaintext highlighter-rouge">PackageInstaller</code> can approve user-authorized installations, maintaining security by preventing unauthorized apps from manipulating the process.</p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="pia"><span class="me-2">PIA</span><a href="#pia" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>While google is refactoring the process and UI, guarded by the <a href="https://cs.android.com/android/platform/superproject/main/+/main:frameworks/base/core/java/android/content/pm/flags.aconfig;drc=82ada6503a81af7eeed2924a2d2d942375f6c8c2;l=109">pia_v2</a> flag, but this is not yet enabled. This discussion focuses on the traditional installation process.</p>

<p>Internally, <code class="language-plaintext highlighter-rouge">PIA</code> functions similarly to a session-based installation but offers developers a simpler and more convenient API. <code class="language-plaintext highlighter-rouge">PackageInstaller</code> handles most tasks for the client app, including creating the session, copying the apk stream to the session, and committing the session.</p>

<p>The installation process involves the following steps:</p>

<ol>
  <li>
    <p>Initiating Installation:</p>

    <ul>
      <li>The client triggers an installation by sending an intent with the action <code class="language-plaintext highlighter-rouge">android.intent.action.INSTALL_PACKAGE</code>, specifying a content URI as the data source.</li>
    </ul>
  </li>
  <li>
    <p>Handling the Intent:</p>

    <ul>
      <li>The <code class="language-plaintext highlighter-rouge">PackageInstaller</code> receives the intent and processes it through the <code class="language-plaintext highlighter-rouge">InstallStart</code> activity, configured as follows:</li>
    </ul>

    <div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">".InstallStart"</span>
            <span class="na">android:exported=</span><span class="s">"true"</span>
            <span class="na">android:excludeFromRecents=</span><span class="s">"true"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;intent-filter</span> <span class="na">android:priority=</span><span class="s">"1"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.VIEW"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">"android.intent.action.INSTALL_PACKAGE"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">"android.intent.category.DEFAULT"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">"content"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;data</span> <span class="na">android:mimeType=</span><span class="s">"application/vnd.android.package-archive"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
  <li>
    <p>Staging the apk</p>

    <ul>
      <li>After validating and extracting necessary parameters, the <code class="language-plaintext highlighter-rouge">InstallStart</code> activity launches the <code class="language-plaintext highlighter-rouge">InstallStaging</code> activity to prepare the apk for installation. This includes:
        <ul>
          <li>Creating session parameters for the installation.</li>
          <li>Displaying a progress dialog for staging.</li>
          <li>Copying the apk payload to a <code class="language-plaintext highlighter-rouge">PackageInstallSession</code>.</li>
          <li>Retrieving the resolved base apk file path (generated by <code class="language-plaintext highlighter-rouge">PackageInstallSession</code>) and passing it to the <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code>.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    <p>User Confirmation:</p>

    <p>The <code class="language-plaintext highlighter-rouge">PackageInstallerActivity</code> presents a confirmation dialog to the user. Once the user confirms the installation, control is passed to <code class="language-plaintext highlighter-rouge">InstallInstalling</code>, which handles the final phase of committing the session and completing the installation.</p>
  </li>
  <li>
    <p>Completing the Installation:
The <code class="language-plaintext highlighter-rouge">InstallInstalling</code> activity invokes <code class="language-plaintext highlighter-rouge">PackageInstallationSession.commit(IntentSender, forTransfer)</code> to finalize the installation.
Unlike a standard session-based installation, this session is created and commited by <code class="language-plaintext highlighter-rouge">PackageInstaller</code>, which holds the <code class="language-plaintext highlighter-rouge">INSTALL_PACKAGES</code> permission. As a result, the <code class="language-plaintext highlighter-rouge">computeUserActionRequirement</code> method returns <code class="language-plaintext highlighter-rouge">USER_ACTION_NOT_NEEDED</code>, allowing the installation to proceed without suspension.</p>

    <div class="language-java highlighter-rouge"><div class="code-header">
        <span data-label-text="Java"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>  <span class="nd">@UserActionRequirement</span>
  <span class="kd">private</span> <span class="kt">int</span> <span class="nf">computeUserActionRequirement</span><span class="o">()</span> <span class="o">{</span>
      <span class="o">...</span>
      <span class="c1">// For the below cases, force user action prompt</span>
      <span class="c1">// 1. installFlags includes INSTALL_FORCE_PERMISSION_PROMPT</span>
      <span class="c1">// 2. params.requireUserAction is USER_ACTION_REQUIRED</span>
      <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">forceUserActionPrompt</span> <span class="o">=</span>
              <span class="o">(</span><span class="n">params</span><span class="o">.</span><span class="na">installFlags</span> <span class="o">&amp;</span> <span class="nc">PackageManager</span><span class="o">.</span><span class="na">INSTALL_FORCE_PERMISSION_PROMPT</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0</span>
                      <span class="o">||</span> <span class="n">params</span><span class="o">.</span><span class="na">requireUserAction</span> <span class="o">==</span> <span class="nc">SessionParams</span><span class="o">.</span><span class="na">USER_ACTION_REQUIRED</span><span class="o">;</span>
      <span class="kd">final</span> <span class="kt">int</span> <span class="n">userActionNotTypicallyNeededResponse</span> <span class="o">=</span> <span class="n">forceUserActionPrompt</span>
              <span class="o">?</span> <span class="no">USER_ACTION_REQUIRED</span>
              <span class="o">:</span> <span class="no">USER_ACTION_NOT_NEEDED</span><span class="o">;</span>

      <span class="o">...</span>
      <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">isInstallPermissionGranted</span> <span class="o">=</span>
              <span class="o">(</span><span class="n">snapshot</span><span class="o">.</span><span class="na">checkUidPermission</span><span class="o">(</span><span class="n">android</span><span class="o">.</span><span class="na">Manifest</span><span class="o">.</span><span class="na">permission</span><span class="o">.</span><span class="na">INSTALL_PACKAGES</span><span class="o">,</span>
                      <span class="n">mInstallerUid</span><span class="o">)</span> <span class="o">==</span> <span class="nc">PackageManager</span><span class="o">.</span><span class="na">PERMISSION_GRANTED</span><span class="o">);</span> <span class="c1">// ⬅️</span>

      <span class="o">...</span>
      <span class="kd">final</span> <span class="kt">boolean</span> <span class="n">isPermissionGranted</span> <span class="o">=</span> <span class="n">isInstallPermissionGranted</span>
              <span class="o">||</span> <span class="o">(</span><span class="n">isUpdatePermissionGranted</span> <span class="o">&amp;&amp;</span> <span class="n">isUpdate</span><span class="o">)</span>
              <span class="o">||</span> <span class="o">(</span><span class="n">isSelfUpdatePermissionGranted</span> <span class="o">&amp;&amp;</span> <span class="n">isSelfUpdate</span><span class="o">)</span>
              <span class="o">||</span> <span class="o">(</span><span class="n">isInstallDpcPackagesPermissionGranted</span> <span class="o">&amp;&amp;</span> <span class="n">hasDeviceAdminReceiver</span><span class="o">);</span>
      <span class="o">...</span>
      <span class="k">if</span> <span class="o">(</span><span class="n">isPermissionGranted</span><span class="o">)</span> <span class="o">{</span>
          <span class="k">return</span> <span class="n">userActionNotTypicallyNeededResponse</span><span class="o">;</span> <span class="c1">// ⬅️</span>
      <span class="o">}</span>
     <span class="o">...</span>
  <span class="o">}</span>
</pre></td></tr></tbody></table></code></div>    </div>
  </li>
</ol>

<h2 id="conclusion"><span class="me-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Android’s sideloading process, whether <code class="language-plaintext highlighter-rouge">Session Install</code> or <code class="language-plaintext highlighter-rouge">PIA</code>, hinges on <strong>strong user consent</strong> in <code class="language-plaintext highlighter-rouge">PackageInstaller</code>, gated by the <code class="language-plaintext highlighter-rouge">INSTALL_PACKAGES</code> privilege permission, orchestrated by system services like <code class="language-plaintext highlighter-rouge">PackageInstallerService</code>, form a critical security barrier</p>

<p>My experience with Samsung’s ISVP revealed a silent installation vulnerability that bypassed user interaction. Such exploitation patterns have significant real-world implications if adopted by threat actors. When OEMs modify AOSP code to serve commercial interests without sufficient security testing, the consequences can be severe. In these cases, collaboration with security researchers isn’t optional, it’s essential.</p>

<p>Engage sincerely with white-hat researchers and honor your commitments, repeated disappointment and broken promises will ultimately erode your reputation.</p>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    

    <!-- tags -->
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=Android%E2%80%99s%20Install%20Flow:%20A%20treasure%20map%20for%20exploit%20crafters%20-%20%E5%BC%80%E5%85%83%E7%B1%B3%E7%B2%89%E5%AE%9E%E5%8A%9B%E4%BB%A3%E8%B4%AD&url=https%3A%2F%2Fkonata.github.io%2Fposts%2Fandroid-application-installation%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fab fa-twitter"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=https%3A%2F%2Fkonata.github.io%2Fposts%2Fandroid-application-installation%2F&text=Android%E2%80%99s%20Install%20Flow:%20A%20treasure%20map%20for%20exploit%20crafters%20-%20%E5%BC%80%E5%85%83%E7%B1%B3%E7%B2%89%E5%AE%9E%E5%8A%9B%E4%BB%A3%E8%B4%AD" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/android-application-installation/">Android’s Install Flow: A treasure map for exploit crafters</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/samsung-bugbounty-scam/">Samsung’s ISVP: Betraying the trust of security researchers</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/android-screen-cast-issues/">"Screen leakage"</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/creator-mismatch/">Creator Mismatch</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/creator-mismatch-cont/">Creator Mismatch 续</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->


















            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->


























            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/samsung-bugbounty-scam/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>Samsung’s ISVP: Betraying the trust of security researchers</p>
    </a>
  

  
    <div class="btn btn-outline-primary disabled" aria-label="Newer">
      <p>-</p>
    </div>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2025</time>

    
      <a href="https://twitter.com/minamikazecafe">natsuki</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.3.0"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->


















    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

